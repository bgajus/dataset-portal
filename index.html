<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Constellation Dataset Portal</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- USWDS init (recommended before CSS) -->
    <script src="https://cdn.jsdelivr.net/npm/@uswds/uswds@3.13.0/dist/js/uswds-init.min.js"></script>

    <!-- USWDS + Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@uswds/uswds@3.13.0/dist/css/uswds.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />

    <!-- Portal shared layer -->
    <link rel="stylesheet" href="/src/assets/css/portal-tokens.css" />
    <link rel="stylesheet" href="/src/assets/css/portal-ui.css" />

    <!-- Home styles -->
    <link rel="stylesheet" href="/src/assets/css/home.css" />

    <!-- Safety: never render the clear X when [hidden] -->
    <style>
      .home-search__clear[hidden]{ display:none !important; }
    </style>
  </head>

  <body data-auth="false">
    <a class="usa-skipnav" href="#main-content">Skip to main content</a>

    <div data-include="portal-header"></div>

    <main id="main-content">
      <!-- Full-width hero (NOT in container) -->
      <section class="home-hero" aria-label="Search datasets">
        <div class="home-hero__inner">
          <h1 class="home-hero__title">Search the Constellation dataset repository.</h1>

          <form
            class="home-hero__search"
            action="/src/pages/search/index.html"
            method="get"
            role="search"
          >
            <label class="usa-sr-only" for="homeSearch">Search datasets</label>

            <div class="home-search">
              <input
                id="homeSearch"
                name="q"
                class="usa-input home-search__input"
                type="search"
                placeholder="Search"
                autocomplete="off"
              />

              <button
                id="homeClear"
                class="home-search__clear"
                type="button"
                aria-label="Clear search"
                hidden
              >
                <i class="fa-solid fa-xmark" aria-hidden="true"></i>
              </button>

              <button
                class="usa-button btnBrandSolid home-search__btn"
                type="submit"
                aria-label="Search"
              >
                <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
              </button>
            </div>
          </form>
        </div>
      </section>

      <!-- Main content container region (MATCHES search/editor) -->
      <div class="padding-y-4">
        <div class="grid-container-widescreen">
          <section aria-label="Browse by category">
            <header class="home-sectionhead">
              <h2 class="home-sectionhead__title">Browse by category</h2>
              <p class="home-sectionhead__sub">
                Jump straight into search results filtered by category.
              </p>
            </header>

            <div class="home-cats" role="list">
              <a role="listitem" class="home-catcard" href="/src/pages/search/index.html?category=Climate">
                Climate
              </a>
              <a role="listitem" class="home-catcard" href="/src/pages/search/index.html?category=Energy">
                Energy
              </a>
              <a role="listitem" class="home-catcard" href="/src/pages/search/index.html?category=Materials">
                Materials
              </a>
              <a role="listitem" class="home-catcard" href="/src/pages/search/index.html?category=Biology">
                Biology
              </a>
              <a role="listitem" class="home-catcard" href="/src/pages/search/index.html?category=Chemistry">
                Chemistry
              </a>
              <a role="listitem" class="home-catcard" href="/src/pages/search/index.html?category=Physics">
                Physics
              </a>
              <a role="listitem" class="home-catcard" href="/src/pages/search/index.html?category=Earth%20Science">
                Earth Science
              </a>
              <a role="listitem" class="home-catcard" href="/src/pages/search/index.html?category=Computer%20Science">
                Computer Science
              </a>
              <a role="listitem" class="home-catcard" href="/src/pages/search/index.html?category=Engineering">
                Engineering
              </a>
              <a role="listitem" class="home-catcard" href="/src/pages/search/index.html?category=Other">
                Other
              </a>
            </div>
          </section>
        </div>
      </div>
    </main>

    <div data-include="portal-footer"></div>

    <!-- USWDS JS -->
    <script src="https://cdn.jsdelivr.net/npm/@uswds/uswds@3.13.0/dist/js/uswds.min.js"></script>

    <!-- Shared includes loader -->
    <script src="/src/assets/js/includes.js"></script>

    <!-- Home search behavior (clear button) -->
    <script>
      (function(){
        const input = document.getElementById('homeSearch');
        const clearBtn = document.getElementById('homeClear');
        if(!input || !clearBtn) return;

        function sync(){
          const v = (input.value || '').trim();
          clearBtn.hidden = v.length === 0;
        }

        // Initial sync (covers autofill / bfcache)
        sync();

        input.addEventListener('input', sync);
        input.addEventListener('blur', sync);

        clearBtn.addEventListener('click', () => {
          input.value = '';
          sync();
          input.focus();
        });
      })();
    </script>
  </body>
</html>
