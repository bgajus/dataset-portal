const m=[{value:"ND",label:"ND — Numeric Data"},{value:"AS",label:"AS — Animations/Simulations"},{value:"SM",label:"SM — Specialized Mix"},{value:"SW",label:"SW — Software"},{value:"IM",label:"IM — Interactive Maps/GIS Data"}],y=["Bioinformatics","Climate","Computational Fluid Dynamics","Cybersecurity","Energy Systems","Environmental Monitoring","Fusion","Geospatial Analytics","HPC Performance","Machine Learning","Materials Science","Nuclear Energy","Remote Sensing","Robotics","Transportation","Urban Sensing"],I=["machine learning","deep learning","artificial intelligence","high performance computing","HPC","simulation","computational fluid dynamics","climate modeling","remote sensing","geospatial","materials science","bioinformatics","cybersecurity","fusion","benchmarking","performance","visualization","time series"],c=[{id:"upload",label:"Upload Files",required:!0,kind:"special"},{id:"description",label:"Description",required:!0,kind:"fields",fields:[{key:"title",label:"Title",type:"text",required:!0},{key:"datasetType",label:"Dataset Type",type:"select",required:!0,options:m,placeholder:"Select a type"},{key:"description",label:"Description",type:"textarea",required:!0,rows:5},{key:"softwareNeeded",label:"Software Needed",type:"text",required:!1,hint:"List any software needed to use this dataset."}]},{id:"authors",label:"Authors",required:!0,kind:"special",authorRules:{minAuthors:1,requiredFields:["firstName","lastName","affiliation","email"]}},{id:"subjects",label:"Subjects",required:!1,kind:"fields",fields:[{key:"subjects",label:"Subjects",type:"multiselect",required:!1,options:y,hint:"Tip: Hold Ctrl (Windows) or ⌘ (Mac) to select multiple."},{key:"keywords",label:"Keywords",type:"keywords",required:!1,hint:"Comma-separated keywords. Suggestions will appear as you type.",placeholder:"e.g., fusion, plasma, diagnostics"}]},{id:"funding",label:"Funding Information",required:!0,kind:"fields",fields:[{key:"fundingInfo.sponsoringOrganizations",label:"Sponsoring Organizations",type:"text",required:!0},{key:"fundingInfo.originatingResearchOrganization",label:"Originating Research Organization",type:"text",required:!0},{key:"fundingInfo.otherContributingOrganizations",label:"Other Contributing Organizations",type:"text",required:!1},{key:"fundingInfo.doeContractNumber",label:"DOE Contract Number",type:"text",required:!0},{key:"fundingInfo.olcfProjectIdentifier",label:"OLCF Project Identifier",type:"text",required:!1},{key:"fundingInfo.otherContractNumbers",label:"Other Contract Number(s)",type:"text",required:!1},{key:"fundingInfo.otherIdentifyingNumbers",label:"Other Identifying Numbers",type:"text",required:!1}]},{id:"related",label:"Related Works",required:!1,kind:"fields",conditionalRequired:{mode:"any-to-all",keys:["relatedWork.relatedIdentifier","relatedWork.relatedIdentifierType","relatedWork.relationType"],note:"If related work is added, all fields are required."},fields:[{key:"relatedWork.relatedIdentifier",label:"Related Identifier",type:"text",required:!1},{key:"relatedWork.relatedIdentifierType",label:"Related Identifier Type",type:"text",required:!1},{key:"relatedWork.relationType",label:"Relation Type",type:"text",required:!1}]}];function A(r){return c.find(e=>e.id===r)||null}function N(){return c.flatMap(r=>Array.isArray(r.fields)?r.fields.map(e=>({...e,section:r.id})):[])}function h(r,e){const n=String(e||"").split(".").filter(Boolean);let t=r;for(const o of n){if(t==null)return;t=t[o]}return t}function w(r,e,n){const t=String(e||"").split(".").filter(Boolean);if(!t.length)return r;let o=r;for(let i=0;i<t.length-1;i++){const l=t[i];(typeof o[l]!="object"||o[l]===null)&&(o[l]={}),o=o[l]}return o[t[t.length-1]]=n,r}function u(){return{title:"",description:"",datasetType:"",softwareNeeded:"",uploadedFiles:[],authors:[],subjects:[],keywords:[],fundingInfo:{sponsoringOrganizations:"",originatingResearchOrganization:"",otherContributingOrganizations:"",doeContractNumber:"",olcfProjectIdentifier:"",otherContractNumbers:"",otherIdentifyingNumbers:""},relatedWork:{relatedIdentifier:"",relatedIdentifierType:"",relationType:""}}}const a="constellation:records:v2",p=["constellation:records:v1"],b=[{doi:"10.13139/ORNLNCCS/1400999",title:"Tombstoned Dataset (Blackhole Demo)",status:"Tombstoned",createdAt:new Date(2023,6,18).toISOString(),updatedAt:new Date(2025,8,22).toISOString(),tombstone:{tombstonedAt:new Date(2025,8,22,14,10,0).toISOString(),reason:"Withdrawn due to an issue discovered in the underlying source data. The dataset is no longer available for download.",replacementUrl:"https://doi.org/10.13139/ORNLNCCS/1401001",notes:""}},{doi:"10.13139/ORNLNCCS/1400998",title:"Retired Benchmark Outputs (Tombstoned)",status:"Tombstoned",createdAt:new Date(2022,2,4).toISOString(),updatedAt:new Date(2024,11,3).toISOString(),tombstone:{tombstonedAt:new Date(2024,11,3,9,30,0).toISOString(),reason:"Withdrawn at the request of the project team. A newer benchmark series supersedes these results.",replacementUrl:"10.13139/ORNLNCCS/1401002",notes:""}}];function d(){try{const r=localStorage.getItem(a);if(!r)return;const e=JSON.parse(r);if(!e||typeof e!="object"||Array.isArray(e))return;let n=!1;b.forEach(t=>{!t||!t.doi||e[t.doi]||(e[t.doi]=s(t),n=!0)}),n&&localStorage.setItem(a,JSON.stringify(e))}catch{}}function f(){try{if(localStorage.getItem(a))return;for(const e of p){const n=localStorage.getItem(e);if(!n)continue;const t=JSON.parse(n),o={};!Array.isArray(t)&&typeof t=="object"&&t!==null?Object.values(t).forEach(i=>{i&&i.doi&&(o[i.doi]=s(i))}):Array.isArray(t)&&t.forEach(i=>{i&&i.doi&&(o[i.doi]=s(i))}),localStorage.setItem(a,JSON.stringify(o));return}}catch(r){console.warn("Legacy store migration failed:",r)}}function g(r){const e={...r},n=u();return e.fundingInfo={...n.fundingInfo,...e.fundingInfo||{}},e.relatedWork={...n.relatedWork,...e.relatedWork||{}},e.softwareNeeded=String(e.softwareNeeded||""),e.uploadedFiles=Array.isArray(e.uploadedFiles)?e.uploadedFiles:[],e.authors=Array.isArray(e.authors)?e.authors:[],e.tombstone=e.tombstone&&typeof e.tombstone=="object"?e.tombstone:{},e.tombstone={tombstonedAt:String(e.tombstone.tombstonedAt||""),reason:String(e.tombstone.reason||""),replacementUrl:String(e.tombstone.replacementUrl||""),notes:String(e.tombstone.notes||"")},Array.isArray(e.subjects)||(e.subjects=[]),e.subjects=e.subjects.map(t=>String(t||"").trim()).filter(Boolean),e.subjectsKeywords=e.subjects.join(", "),Array.isArray(e.keywords)||(e.keywords=[]),e.keywords=e.keywords.map(t=>String(t||"").trim()).filter(Boolean),e.funding=e.funding&&typeof e.funding=="object"?e.funding:{funderName:"",awardNumber:""},!e.funding.funderName&&e.fundingInfo.sponsoringOrganizations&&(e.funding.funderName=e.fundingInfo.sponsoringOrganizations),!e.funding.awardNumber&&e.fundingInfo.doeContractNumber&&(e.funding.awardNumber=e.fundingInfo.doeContractNumber),e}function s(r){if(!r)return r;const e={...r},n=u();if((!e.fundingInfo||typeof e.fundingInfo!="object")&&(e.fundingInfo={...n.fundingInfo}),e.fundingInfo={...n.fundingInfo,...e.fundingInfo},e.funding&&typeof e.funding=="object"&&(!e.fundingInfo.sponsoringOrganizations&&e.funding.funderName&&(e.fundingInfo.sponsoringOrganizations=String(e.funding.funderName||"")),!e.fundingInfo.doeContractNumber&&e.funding.awardNumber&&(e.fundingInfo.doeContractNumber=String(e.funding.awardNumber||""))),(!e.relatedWork||typeof e.relatedWork!="object")&&(e.relatedWork={...n.relatedWork}),e.relatedWork={...n.relatedWork,...e.relatedWork},!e.softwareNeeded&&e.software&&(e.softwareNeeded=String(e.software||"")),Array.isArray(e.uploadedFiles)||(e.uploadedFiles=[]),(!e.tombstone||typeof e.tombstone!="object")&&(e.tombstone={}),e.tombstone={tombstonedAt:String(e.tombstone.tombstonedAt||""),reason:String(e.tombstone.reason||""),replacementUrl:String(e.tombstone.replacementUrl||""),notes:String(e.tombstone.notes||"")},!Array.isArray(e.subjects)||e.subjects.length===0){const t=String(e.subjectsKeywords||"").trim();t?e.subjects=t.split(",").map(o=>o.trim()).filter(Boolean):e.subjects=Array.isArray(e.subjects)?e.subjects:[]}return Array.isArray(e.keywords)||(e.keywords=[]),typeof e.softwareNeeded!="string"&&(e.softwareNeeded=""),e}function k(){try{f(),d();const r=localStorage.getItem(a);if(!r)return[];const e=JSON.parse(r);if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return Object.values(e).filter(n=>n&&n.doi).map(s);if(Array.isArray(e)){const n={};return e.forEach(t=>{t&&t.doi&&(n[t.doi]=s(t))}),localStorage.setItem(a,JSON.stringify(n)),d(),Object.values(n)}return[]}catch(r){return console.error("Failed to load records from store:",r),[]}}function O(r){if(!r)return null;try{f(),d();const e=localStorage.getItem(a);if(!e)return null;const n=JSON.parse(e);return typeof n=="object"&&n!==null&&!Array.isArray(n)?s(n[r]||null):Array.isArray(n)?s(n.find(t=>t&&t.doi===r)||null):null}catch(e){return console.error("Failed to get record:",e),null}}function S(r){if(!r||!r.doi)return console.warn("Cannot save record without valid DOI"),!1;try{f(),d();const e=localStorage.getItem(a),n=e?JSON.parse(e):{},t=new Date().toISOString(),o=g(r);return n[r.doi]={...o,updatedAt:t,createdAt:r.createdAt||t},localStorage.setItem(a,JSON.stringify(n)),!0}catch(e){return console.error("Failed to save record:",e),!1}}function j(r="Untitled Dataset"){const n=`10.13139/ORNLNCCS/${Date.now().toString().slice(-7)}`,t=new Date().toISOString(),o=u(),i=g({doi:n,...o,title:r.trim()||"Untitled Dataset",status:"Draft",createdAt:t,updatedAt:t,funding:{funderName:"",awardNumber:""},related:[]});return S(i)||console.warn("Failed to save new draft"),i}export{m as D,I as K,c as M,y as S,O as a,h as b,j as c,N as d,A as e,w as f,k as g,S as s};
